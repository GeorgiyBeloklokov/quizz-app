{"ast":null,"code":"import { createApi } from '@reduxjs/toolkit/query/react';\nimport { customFetchBase } from '.';\nimport { setIsAuth, setToken } from '../reducers/userSlice';\nexport const registrationApi = createApi({\n  reducerPath: 'registrationApi',\n  baseQuery: customFetchBase,\n  endpoints: builder => ({\n    registrationUser: builder.mutation({\n      query(data) {\n        return {\n          url: 'auth/registration',\n          method: 'POST',\n          body: data\n          //credentials: 'include',\n        };\n      },\n\n      async onQueryStarted(args, _ref) {\n        let {\n          dispatch,\n          queryFulfilled\n        } = _ref;\n        try {\n          const {\n            data\n          } = await queryFulfilled;\n          dispatch(setToken(data));\n          dispatch(setIsAuth(true));\n          const token = data.token;\n          console.log(`data =>>>>>>>>`, token);\n          localStorage.setItem('token', token);\n        } catch (error) {\n          console.log(`error =>>>>>>>>>>`, error);\n        }\n      }\n    })\n  })\n});\nexport const {\n  useRegistrationUserMutation\n} = registrationApi;","map":{"version":3,"names":["createApi","customFetchBase","setIsAuth","setToken","registrationApi","reducerPath","baseQuery","endpoints","builder","registrationUser","mutation","query","data","url","method","body","onQueryStarted","args","dispatch","queryFulfilled","token","console","log","localStorage","setItem","error","useRegistrationUserMutation"],"sources":["C:/Users/georg/Desktop/diskD/diskD/my/read-books/src/store/api/RegistrationApi.ts"],"sourcesContent":["import { createApi } from '@reduxjs/toolkit/query/react';\r\nimport { customFetchBase } from '.';\r\nimport { LoginInput } from '../../components/utils/types';\r\nimport { setIsAuth, setToken } from '../reducers/userSlice';\r\n\r\nexport const registrationApi = createApi({\r\n  reducerPath: 'registrationApi',\r\n  baseQuery: customFetchBase,\r\n  endpoints: (builder) => ({\r\n    registrationUser: builder.mutation<string, LoginInput>({\r\n      query(data) {\r\n        return {\r\n          url: 'auth/registration',\r\n          method: 'POST',\r\n          body: data,\r\n          //credentials: 'include',\r\n        };\r\n      },\r\n      async onQueryStarted(args, { dispatch, queryFulfilled }) {\r\n        try {\r\n          const { data } = await queryFulfilled;\r\n          dispatch(setToken(data));\r\n          dispatch(setIsAuth(true));\r\n          const token = data.token;\r\n          console.log(`data =>>>>>>>>`, token);\r\n          localStorage.setItem('token', token);\r\n        } catch (error) {\r\n          console.log(`error =>>>>>>>>>>`, error);\r\n        }\r\n      },\r\n    }),\r\n  }),\r\n});\r\n\r\nexport const { useRegistrationUserMutation } = registrationApi;\r\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,8BAA8B;AACxD,SAASC,eAAe,QAAQ,GAAG;AAEnC,SAASC,SAAS,EAAEC,QAAQ,QAAQ,uBAAuB;AAE3D,OAAO,MAAMC,eAAe,GAAGJ,SAAS,CAAC;EACvCK,WAAW,EAAE,iBAAiB;EAC9BC,SAAS,EAAEL,eAAe;EAC1BM,SAAS,EAAGC,OAAO,KAAM;IACvBC,gBAAgB,EAAED,OAAO,CAACE,QAAQ,CAAqB;MACrDC,KAAK,CAACC,IAAI,EAAE;QACV,OAAO;UACLC,GAAG,EAAE,mBAAmB;UACxBC,MAAM,EAAE,MAAM;UACdC,IAAI,EAAEH;UACN;QACF,CAAC;MACH,CAAC;;MACD,MAAMI,cAAc,CAACC,IAAI,QAAgC;QAAA,IAA9B;UAAEC,QAAQ;UAAEC;QAAe,CAAC;QACrD,IAAI;UACF,MAAM;YAAEP;UAAK,CAAC,GAAG,MAAMO,cAAc;UACrCD,QAAQ,CAACf,QAAQ,CAACS,IAAI,CAAC,CAAC;UACxBM,QAAQ,CAAChB,SAAS,CAAC,IAAI,CAAC,CAAC;UACzB,MAAMkB,KAAK,GAAGR,IAAI,CAACQ,KAAK;UACxBC,OAAO,CAACC,GAAG,CAAE,gBAAe,EAAEF,KAAK,CAAC;UACpCG,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEJ,KAAK,CAAC;QACtC,CAAC,CAAC,OAAOK,KAAK,EAAE;UACdJ,OAAO,CAACC,GAAG,CAAE,mBAAkB,EAAEG,KAAK,CAAC;QACzC;MACF;IACF,CAAC;EACH,CAAC;AACH,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEC;AAA4B,CAAC,GAAGtB,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}